"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[347],{347:function(e,n,t){t.r(n),t.d(n,{default:function(){return N}});var s=t(252),o=t(577),c=t(963);const l=e=>((0,s.dD)("data-v-1d053821"),e=e(),(0,s.Cn)(),e),i=l((()=>(0,s._)("h2",null,"4CHAT",-1))),a=l((()=>(0,s._)("br",null,null,-1))),r=l((()=>(0,s._)("br",null,null,-1))),u={class:"chatlist"},d={class:"tableclass"},h=l((()=>(0,s._)("tr",null,[(0,s._)("th",{class:"author_col"},"Author"),(0,s._)("th",null,"Message")],-1))),_={class:"author_col"},p=["disabled"],g=["disabled"];function w(e,n,t,l,w,b){return(0,s.wg)(),(0,s.iD)(s.HY,null,[i,(0,s._)("span",null,"Connection: "+(0,o.zw)(w.connection_good?"alive":"dead"),1),a,(0,s._)("span",null,"Users: "+(0,o.zw)(w.connected_users),1),r,(0,s._)("div",u,[(0,s._)("table",d,[h,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(w.messages,((e,n)=>((0,s.wg)(),(0,s.iD)("tr",{key:n},[(0,s._)("td",_,(0,o.zw)(e[0]||"FAILED"),1),(0,s._)("td",null,(0,o.zw)(e[1]||"FAILED"),1)])))),128))])]),(0,s._)("form",{action:"wss://websocket-server.creepreplit.repl.co/",onSubmit:n[0]||(n[0]=(0,c.iM)(((...e)=>b.sendMessage&&b.sendMessage(...e)),["prevent"]))},[(0,s._)("input",{ref:"textInput",style:{width:"400px"},type:"text",disabled:!w.connection_good},null,8,p),(0,s._)("input",{type:"submit",disabled:!w.connection_good},null,8,g)],32)],64)}var b={data(){return{connection:null,messages:[],reconnector:null,connected_users:0,connection_good:!1}},mounted(){this.connect()},unmounted(){this.connection.close(1e3)},watch:{connection(e){null==e?this.start_reconnector():clearInterval(this.reconnector)}},methods:{connect(){this.connection=new WebSocket("wss://websocket-server.creepreplit.repl.co/"),this.connection.onmessage=e=>{const n=JSON.parse(e.data);"message"==n["type"]?this.messages.push([n["author"],n["content"]]):"info"==n["type"]?this.connected_users=n["user_count"]:(this.messages.push(["CLIENT","Got bad data"]),console.log("BAD DATA",n))},this.connection.onclose=()=>{this.connection=null,this.messages.push(["CLIENT","CONNECTION FAILED"]),this.connection_good=!1},this.connection.onopen=()=>{this.messages.push(["CLIENT","CONNECTED"]),this.connection.send(JSON.stringify({type:"info"})),this.connection_good=!0}},sendMessage(){const e=this.$refs.textInput,n=e.value;e.value="",this.connection.send(JSON.stringify({type:"message",content:n}))},start_reconnector(){this.reconnector=setInterval((()=>{this.messages.push(["CLIENT","RECONNECTING"]),this.connect()}),5e3)}}},m=t(744);const C=(0,m.Z)(b,[["render",w],["__scopeId","data-v-1d053821"]]);var N=C}}]);
//# sourceMappingURL=347.1f0fbacc.js.map